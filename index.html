<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ملف محمود سعد - React</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Naskh+Arabic:wght@400;600;700&family=Orbitron:wght@400;700&display=swap" rel="stylesheet">

    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.163.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.163.0/examples/jsm/"
            }
        }
    </script>

    <style>
        /* --- بداية CSS (نفس كود CSS من الإصدار السابق مع بعض التعديلات الطفيفة للعمل مع React) --- */

        /* 1. المتغيرات والإعدادات العامة */
        @keyframes backgroundShift { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        @keyframes intenseGlow { 0%, 100% { text-shadow: 0 0 8px var(--glow-color1), 0 0 18px var(--glow-color1), 0 0 4px var(--glow-color2), 0 0 30px var(--accent1); filter: brightness(1.2); } 50% { text-shadow: 0 0 12px var(--glow-color2), 0 0 25px var(--glow-color2), 0 0 6px var(--glow-color1), 0 0 35px var(--accent2); filter: brightness(1.3); } }
        @keyframes cardHoverPulse { 0% { transform: translateY(-10px) scale(1.03); box-shadow: 0 15px 50px rgba(0,0,0, 0.5), 0 0 35px var(--glow-color1), 0 0 15px var(--glow-color2); } 50% { transform: translateY(-12px) scale(1.035); box-shadow: 0 18px 60px rgba(0,0,0, 0.6), 0 0 45px var(--glow-color1), 0 0 20px var(--glow-color2); } 100% { transform: translateY(-10px) scale(1.03); box-shadow: 0 15px 50px rgba(0,0,0, 0.5), 0 0 35px var(--glow-color1), 0 0 15px var(--glow-color2); } }
        @keyframes borderGlow { 0% { box-shadow: 0 0 6px var(--glow-color1), inset 0 0 6px var(--glow-color1); } 50% { box-shadow: 0 0 12px var(--glow-color2), inset 0 0 12px var(--glow-color2); } 100% { box-shadow: 0 0 6px var(--glow-color1), inset 0 0 6px var(--glow-color1); } }
        @keyframes shootingStar { 0% { transform: translateX(100vw) translateY(-100px) scale(0.5); opacity: 1; } 70% { opacity: 1; } 100% { transform: translateX(-100vw) translateY(calc(100vh + 100px)) scale(0.2); opacity: 0; } }
        @keyframes starTwinkle { 0%, 100% { transform: scale(1); opacity: 0.6; } 50% { transform: scale(1.3); opacity: 1; } }
        @keyframes sunShine { 0% { box-shadow: 0 0 30px 10px gold, 0 0 50px 20px orange, inset 0 0 20px yellow; opacity: 0.9; } 50% { box-shadow: 0 0 40px 15px gold, 0 0 60px 25px orange, inset 0 0 25px yellow; opacity: 1; } 100% { box-shadow: 0 0 30px 10px gold, 0 0 50px 20px orange, inset 0 0 20px yellow; opacity: 0.9; } }
        @keyframes chandelierGlow { 0%, 100% { text-shadow: 0 0 5px gold, 0 0 10px gold; color: yellow; } 50% { text-shadow: 0 0 8px orange, 0 0 15px gold; color: lightyellow; } }

        :root {
            /* --- Night Mode (Default) --- */
            --bg-dark: #010105; --bg-card: #0c0c18; --bg-card-transparent: rgba(12, 12, 24, 0.9);
            --text-primary: #f5f5ff; --text-secondary: #b0b8d8; --accent1: #00ffff;
            --accent2: #ff33cc; --accent3: #00ffcc;
            --accent-gradient: linear-gradient(90deg, var(--accent1) 0%, var(--accent2) 50%, var(--accent3) 100%);
            --border-color: rgba(0, 255, 255, 0.4); --border-color-hover: var(--accent1);
            --glow-color1: rgba(0, 255, 255, 0.9); --glow-color2: rgba(255, 51, 204, 0.8);
            --shadow-color: rgba(0, 255, 255, 0.25);
            --body-bg-gradient: linear-gradient(-45deg, #010105, #03030a, #060610, #020208);
            --star-color: white; --sun-opacity: 0; --chandelier-icon-color: var(--text-secondary);
            --chandelier-glow-animation: none;

            /* --- Fonts & Transitions --- */
            --font-arabic: 'Noto Naskh Arabic', 'Cairo', sans-serif;
            --font-futuristic: 'Orbitron', sans-serif;
            --transition-speed: 0.35s; --transition-cubic: cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        /* --- Day Mode Variables --- */
        body.light-mode {
            --bg-dark: #f0f5ff; --bg-card: #ffffff; --bg-card-transparent: rgba(255, 255, 255, 0.9);
            --text-primary: #101030; --text-secondary: #505070; --accent1: #0077cc;
            --accent2: #cc0077; --accent3: #009977;
            --accent-gradient: linear-gradient(90deg, var(--accent1) 0%, var(--accent2) 100%);
            --border-color: rgba(0, 119, 204, 0.3); --border-color-hover: var(--accent1);
            --glow-color1: rgba(0, 119, 204, 0.5); --glow-color2: rgba(204, 0, 119, 0.4);
            --shadow-color: rgba(0, 119, 204, 0.15);
            --body-bg-gradient: linear-gradient(45deg, #e0eaff, #f0f5ff, #ffffff, #f0f5ff);
            --star-color: transparent; --sun-opacity: 1; --chandelier-icon-color: var(--text-secondary);
            --chandelier-glow-animation: none;
        }
        body.light-mode .chandelier.on i { color: darkorange; text-shadow: 0 0 5px orange; --chandelier-glow-animation: none; }

        /* --- Base Styles --- */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; font-size: 16px; }
        body {
            font-family: var(--font-arabic); background-color: var(--bg-dark);
            background: var(--body-bg-gradient); background-size: 400% 400%;
            animation: backgroundShift 15s ease infinite; color: var(--text-primary);
            line-height: 1.9; overflow-x: hidden; position: relative;
            transition: background-color 0.5s ease, color 0.5s ease; min-height: 100vh;
        }
        #star-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: -1; overflow: hidden; }
        .star { position: absolute; width: 2px; height: 2px; background-color: var(--star-color); border-radius: 50%; box-shadow: 0 0 5px var(--star-color), 0 0 10px var(--star-color); animation: starTwinkle 3s infinite alternate; transition: background-color 0.5s ease, box-shadow 0.5s ease; }
        .shooting-star { position: absolute; width: 80px; height: 1px; background: linear-gradient(to left, transparent 0%, var(--star-color) 100%); border-radius: 50%; filter: drop-shadow(0 0 6px var(--star-color)); animation: shootingStar linear infinite; opacity: 0; will-change: transform, opacity; }
        #sun { position: fixed; top: 50px; left: 50px; width: 80px; height: 80px; background-color: gold; border-radius: 50%; opacity: var(--sun-opacity); transition: opacity 0.8s ease; z-index: -1; animation: sunShine 5s infinite ease-in-out; }
        .container { max-width: 1150px; margin: 0 auto; padding: 0 30px; }
        h1, h2, h3, h4 { color: var(--text-primary); margin-bottom: 1.2rem; font-weight: 700; letter-spacing: 0.5px; transition: color 0.5s ease; }
        h2.section-title { font-size: 3rem; text-align: center; margin-bottom: 5rem; position: relative; padding-bottom: 25px; color: var(--text-primary); animation: intenseGlow 3s ease-in-out infinite alternate; will-change: text-shadow, filter; }
        h2.section-title::after { content: ''; position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); width: 150px; height: 5px; background: var(--accent-gradient); border-radius: 3px; box-shadow: 0 0 15px var(--glow-color1), 0 0 8px var(--glow-color2); filter: blur(1.5px); transition: background 0.5s ease, box-shadow 0.5s ease; }
        section { padding: 100px 0; position: relative; overflow: hidden; opacity: 0; transform: translateY(80px) scale(0.9); transition: opacity 1.2s var(--transition-cubic), transform 1.2s var(--transition-cubic); will-change: opacity, transform; }
        section.visible { opacity: 1; transform: translateY(0) scale(1); }
        img { max-width: 100%; height: auto; display: block; }
        a { color: var(--accent1); text-decoration: none; transition: color var(--transition-speed) ease, filter 0.3s ease, text-shadow 0.3s ease; text-shadow: 0 0 5px var(--glow-color1); }
        a:hover { color: var(--accent2); filter: brightness(1.4); text-shadow: 0 0 8px var(--glow-color2), 0 0 15px var(--accent2); }
        .card { background-color: var(--bg-card-transparent); padding: 40px; border-radius: 20px; border: 1px solid var(--border-color); box-shadow: 0 12px 40px rgba(0,0,0, 0.4), 0 0 25px var(--shadow-color); transition: all var(--transition-speed) var(--transition-cubic); backdrop-filter: blur(8px); position: relative; overflow: hidden; }
        .card::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%; border-radius: 20px; padding: 2px; background: var(--accent-gradient); mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0); mask-composite: exclude; -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0); -webkit-mask-composite: xor; opacity: 0; transition: opacity 0.4s ease; pointer-events: none; }
        .card:hover { border-color: var(--border-color-hover); animation: cardHoverPulse 1.5s infinite ease-in-out; }
        .card:hover::before { opacity: 1; animation: borderGlow 2s infinite linear; }

        /* --- Controls --- */
        .controls { position: fixed; top: 25px; right: 25px; z-index: 1000; display: flex; gap: 15px; }
        .control-btn { background: var(--bg-card-transparent); color: var(--accent1); border: 1px solid var(--border-color); border-radius: 50%; width: 50px; height: 50px; font-size: 1.5rem; cursor: pointer; display: flex; justify-content: center; align-items: center; box-shadow: 0 0 15px var(--glow-color1), inset 0 0 5px rgba(0, 255, 255, 0.3); transition: all 0.3s ease; backdrop-filter: blur(5px); text-shadow: 0 0 8px var(--glow-color1); will-change: transform, box-shadow, color; }
        .control-btn:hover { background: var(--accent1); color: var(--bg-dark); border-color: var(--accent2); box-shadow: 0 0 25px var(--glow-color1), 0 0 15px var(--glow-color2), inset 0 0 8px rgba(255, 51, 204, 0.5); transform: scale(1.2) rotate(-15deg) translateY(-5px); text-shadow: none; }
        #mode-toggle { position: relative; overflow: hidden; } /* Hide overflow for icon transition */
        #mode-toggle i { transition: transform 0.5s ease, opacity 0.5s ease; display: block; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(1); opacity: 1; }
        body.light-mode #mode-toggle i.fa-moon { transform: translate(-50%, -50%) scale(0); opacity: 0; }
        body:not(.light-mode) #mode-toggle i.fa-sun { transform: translate(-50%, -50%) scale(0); opacity: 0; }


        /* --- Hero Section --- */
        #hero { text-align: center; padding: 100px 0 80px 0; min-height: 100vh; display: flex; flex-direction: column; justify-content: center; align-items: center; margin-bottom: 0; border-radius: 0; opacity: 1; transform: none; transition: none; position: relative; }
        .profile-pic-large { width: 300px; height: 300px; border-radius: 50%; border: 6px solid var(--accent1); box-shadow: 0 0 40px var(--glow-color1), 0 0 70px var(--glow-color1), 0 0 20px var(--glow-color2), inset 0 0 15px rgba(0, 255, 255, 0.5); margin: 0 auto 30px auto; object-fit: cover; transition: transform 0.5s var(--transition-cubic), box-shadow 0.5s ease, border-color 0.5s ease; position: relative; z-index: 1; will-change: transform, opacity, box-shadow; /* Initial state handled by section visibility */ }
        .profile-pic-large:hover { transform: scale(1.1) rotate(5deg) translateY(-10px); box-shadow: 0 0 60px var(--glow-color1), 0 0 90px var(--glow-color1), 0 0 30px var(--glow-color2), inset 0 0 20px rgba(255, 51, 204, 0.6); border-color: var(--accent2); }
        #hero .alias { font-size: 4rem; margin-bottom: 10px; color: var(--text-primary); font-family: var(--font-futuristic); font-weight: 700; letter-spacing: 3px; position: relative; z-index: 1; animation: intenseGlow 3s infinite alternate 1.2s; will-change: text-shadow, filter; /* Entry animation from section */ }
        #hero .name { font-size: 2.5rem; margin-bottom: 18px; font-weight: 600; color: var(--text-primary); position: relative; z-index: 1; }
        #hero .title { font-size: 1.4rem; color: var(--text-secondary); margin-bottom: 35px; max-width: 700px; margin-left: auto; margin-right: auto; position: relative; z-index: 1; font-weight: 400; letter-spacing: 1px; }

        /* --- About Section --- */
        #about { padding: 120px 0; }
        /* .about-content-wrapper inherits .card */
        .about-content-wrapper::before { /* inherits */ }
        #about:hover .about-content-wrapper::before { opacity: 1; animation: borderGlow 2s infinite linear; }
        #about:hover .about-content-wrapper { animation: cardHoverPulse 1.5s infinite ease-in-out; }
        .about-text { flex: 2; min-width: 300px; }
        .about-text h3 { color: var(--accent1); margin-bottom: 1.8rem; padding-bottom: 12px; border-bottom: 2px solid var(--border-color); display: inline-block; font-size: 1.8rem; text-shadow: 0 0 8px var(--glow-color1), 0 0 15px var(--accent1); transition: all 0.5s ease; }
        .personal-info-list { flex: 1; min-width: 280px; list-style: none; padding: 0; padding-inline-start: 35px; border-inline-start: 3px solid var(--border-color); transition: border-color var(--transition-speed) ease; }
        .about-content-wrapper:hover .personal-info-list { border-inline-start-color: var(--accent1); }
        .personal-info-list li { margin-bottom: 18px; font-size: 1.1rem; display: flex; align-items: center; gap: 18px; /* Entry handled by section visibility */ will-change: transform, opacity; }
        .personal-info-list li i { color: var(--accent1); font-size: 1.5rem; width: 35px; text-align: center; transition: all 0.3s ease; flex-shrink: 0; text-shadow: 0 0 10px var(--glow-color1); filter: drop-shadow(0 0 5px var(--glow-color1)); will-change: transform, color, filter; }
        .personal-info-list li:hover i { color: var(--accent2); transform: scale(1.4) rotate(-10deg) translateY(-3px); filter: drop-shadow(0 0 8px var(--glow-color2)); text-shadow: 0 0 12px var(--glow-color2); }
        .personal-info-list li strong { font-weight: 700; margin-inline-end: 10px; color: var(--text-secondary); transition: color 0.5s ease; }

        /* --- Contact Section --- */
        #contact { padding-bottom: 120px; }
        .contact-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap: 40px; }
        /* .contact-item inherits .card */
        .contact-item i { font-size: 3.5rem; color: var(--accent1); margin-bottom: 25px; transition: all 0.3s ease; text-shadow: 0 0 15px var(--glow-color1), 0 0 25px var(--accent1); filter: drop-shadow(0 0 8px var(--glow-color1)); will-change: transform, color, filter, text-shadow; }
        .contact-item:hover i { color: var(--accent2); transform: scale(1.3) rotate(-8deg) translateY(-8px); filter: drop-shadow(0 0 12px var(--glow-color2)); text-shadow: 0 0 18px var(--glow-color2), 0 0 30px var(--accent2); }
        .contact-item a, .contact-item span { font-size: 1.2rem; word-break: break-word; margin-top: auto; }
        .contact-item span { font-size: 0.9em; color: var(--text-secondary); display: block; margin-top: 8px; }

        /* --- Abstract Sphere Section --- */
        #abstract-sphere-section { background: transparent; border-radius: 0; margin-top: 80px; margin-bottom: 80px; padding: 80px 0; }
        #abstract-sphere-section h2.section-title { color: var(--accent3); text-shadow: 0 0 10px var(--glow-color1), 0 0 20px var(--accent3), 0 0 30px var(--accent3); animation: intenseGlow 3s ease-in-out infinite alternate; }
        #abstract-sphere-section h2.section-title::after { background: linear-gradient(90deg, var(--accent1), var(--accent3), var(--accent2)); box-shadow: 0 0 15px var(--glow-color1), 0 0 8px var(--accent3); }
        #sphere-container { width: 100%; max-width: 500px; height: 450px; margin: 40px auto 0 auto; cursor: grab; position: relative; z-index: 1; filter: drop-shadow(0 0 30px var(--shadow-color)); }
        #sphere-container:active { cursor: grabbing; }

        /* --- Experience Section --- */
        #experience { padding-top: 120px; }
        .timeline { position: relative; max-width: 900px; margin: 50px auto 0 auto; }
        .timeline::after { content: ''; position: absolute; width: 4px; background: linear-gradient(to bottom, transparent 0%, var(--accent1) 10%, var(--accent2) 50%, var(--accent1) 90%, transparent 100%); opacity: 1; top: 0; bottom: 0; left: 50%; transform: translateX(-50%); body[dir="rtl"] & { left: auto; right: 50%; transform: translateX(50%); } z-index: 0; box-shadow: 0 0 18px var(--glow-color1), 0 0 10px var(--glow-color2); transition: background 0.5s ease, box-shadow 0.5s ease; }
        .timeline-item { padding: 20px 60px; position: relative; width: 50%; margin-bottom: 80px; /* Entry handled by section */ will-change: opacity, transform; }
        .timeline-item:nth-child(odd) { left: 0; }
        .timeline-item:nth-child(even) { left: 50%; }
        /* Initial positioning for animation */
        .timeline-item:not(.visible) { opacity: 0; }
        .timeline-item:nth-child(odd):not(.visible) { transform: translateX(-80px) skewX(-12deg) scale(0.9); }
        .timeline-item:nth-child(even):not(.visible) { transform: translateX(80px) skewX(12deg) scale(0.9); }
        body[dir="rtl"] .timeline-item:nth-child(odd):not(.visible) { transform: translateX(80px) skewX(12deg) scale(0.9); }
        body[dir="rtl"] .timeline-item:nth-child(even):not(.visible) { transform: translateX(-80px) skewX(-12deg) scale(0.9); }
        .timeline-item.visible { opacity: 1; transform: translateX(0) skewX(0) scale(1); transition: opacity 1s ease-out, transform 1s ease-out; transition-delay: var(--animation-delay, 0.1s); }
        /* Stagger delay needs JS to add style var or class */

        .timeline-item::after { content: ''; position: absolute; width: 22px; height: 22px; background-color: var(--bg-dark); border: 5px solid var(--accent1); top: 30px; border-radius: 50%; z-index: 1; transition: all var(--transition-speed) ease; box-shadow: 0 0 18px var(--glow-color1), inset 0 0 5px var(--glow-color1); will-change: transform, background-color, border-color, box-shadow; }
        .timeline-item:nth-child(odd)::after { right: -11px; body[dir="rtl"] & { left: -11px; right: auto;} }
        .timeline-item:nth-child(even)::after { left: -11px; body[dir="rtl"] & { right: -11px; left: auto;} }
        .timeline-item:hover::after { background-color: var(--accent1); border-color: var(--accent2); transform: scale(1.5) rotate(45deg); box-shadow: 0 0 25px var(--glow-color1), 0 0 15px var(--glow-color2), inset 0 0 8px var(--glow-color2); }
        /* .timeline-content inherits .card */
        .timeline-content::before { /* inherits */ }
        .timeline-item:hover .timeline-content { animation: cardHoverPulse 1.5s infinite ease-in-out; }
        .timeline-item:hover .timeline-content::before { opacity: 1; animation: borderGlow 2s infinite linear; }
        .timeline-content::after { content: " "; height: 0; width: 0; position: absolute; top: 28px; border: 15px solid transparent; transition: border-color var(--transition-speed) ease, filter 0.3s ease; z-index: 2; filter: drop-shadow(0 0 0 transparent); will-change: border-color, filter; }
        .timeline-item:nth-child(odd) .timeline-content::after { right: -30px; border-left-color: var(--bg-card-transparent); body[dir="rtl"] & { right: auto; left: -30px; border-left-color: transparent; border-right-color: var(--bg-card-transparent); } }
        .timeline-item:nth-child(even) .timeline-content::after { left: -30px; border-right-color: var(--bg-card-transparent); body[dir="rtl"] & { left: auto; right: -30px; border-right-color: transparent; border-left-color: var(--bg-card-transparent); } }
        .timeline-item:hover .timeline-content::after { filter: drop-shadow(0 0 10px var(--glow-color1)); }
        /* Adjust hover border color for arrow */
        body:not([dir="rtl"]) .timeline-item:nth-child(odd):hover .timeline-content::after { border-left-color: var(--bg-card); }
        body:not([dir="rtl"]) .timeline-item:nth-child(even):hover .timeline-content::after { border-right-color: var(--bg-card); }
        body[dir="rtl"] .timeline-item:nth-child(odd):hover .timeline-content::after { border-right-color: var(--bg-card); border-left-color: transparent; }
        body[dir="rtl"] .timeline-item:nth-child(even):hover .timeline-content::after { border-left-color: var(--bg-card); border-right-color: transparent; }

        .timeline-content h3 { color: var(--accent1); font-size: 1.7rem; margin-bottom: 0.6rem; text-shadow: 0 0 8px var(--glow-color1), 0 0 15px var(--accent1); transition: color 0.5s ease, text-shadow 0.5s ease; }
        .timeline-content h4 { color: var(--text-secondary); font-size: 1.2rem; margin-bottom: 1.2rem; font-weight: 600; transition: color 0.5s ease; }
        .timeline-content .date { font-size: 1rem; color: var(--accent2); margin-bottom: 1.4rem; display: block; font-weight: 700; letter-spacing: 1px; text-shadow: 0 0 6px var(--glow-color2), 0 0 10px var(--accent2); transition: color 0.5s ease, text-shadow 0.5s ease; }
        .timeline-content .date i { margin-inline-end: 10px; }
        .timeline-content p { color: var(--text-primary); font-size: 1.1rem; transition: color 0.5s ease; }

        /* --- Skills Section --- */
        #skills { padding-bottom: 120px; }
        .skills-languages-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(340px, 1fr)); gap: 45px; align-items: stretch; }
        /* .skills-list, .languages-list inherit .card */
        .skills-list h3, .languages-list h3 { color: var(--accent1); margin-bottom: 2.5rem; padding-bottom: 15px; border-bottom: 2px solid var(--border-color); font-size: 1.8rem; flex-shrink: 0; text-shadow: 0 0 8px var(--glow-color1), 0 0 15px var(--accent1); transition: color 0.5s ease, text-shadow 0.5s ease, border-color 0.5s ease; }
        .skill-item { margin-bottom: 35px; }
        .skill-name { display: block; font-weight: 600; margin-bottom: 12px; font-size: 1.25rem; color: var(--text-primary); transition: color 0.5s ease; }
        .skill-name i { margin-inline-end: 10px; color: var(--accent1); opacity: 0.9; transition: color 0.5s ease; }
        .skill-level { font-size: 0.9rem; margin-bottom: 12px; font-weight: 700; text-transform: uppercase; letter-spacing: 1.5px; display: block; transition: color 0.5s ease, text-shadow 0.5s ease; }
        .skill-level.expert { color: var(--accent3); text-shadow: 0 0 8px var(--accent3); }
        .skill-level.advanced { color: var(--accent1); text-shadow: 0 0 8px var(--accent1); }
        .skill-level.intermediate { color: #ffae42; text-shadow: 0 0 8px #ffae42; }
        .skill-level.beginner { color: var(--accent2); text-shadow: 0 0 8px var(--accent2); }
        .progress-bar-container { background-color: rgba(0, 255, 255, 0.2); border-radius: 6px; height: 10px; overflow: hidden; box-shadow: inset 0 1px 4px rgba(0,0,0,0.6); transition: background-color 0.5s ease; }
        .progress-bar { background: var(--accent-gradient); height: 100%; border-radius: 6px; transition: width 1.5s var(--transition-cubic), background 0.5s ease, box-shadow 0.5s ease; width: 0; box-shadow: 0 0 12px var(--glow-color1), 0 0 6px var(--glow-color2); filter: brightness(1.2); will-change: width; }
        /* .visible class added by JS IntersectionObserver */
        .skills-list.visible .progress-bar { width: var(--progress-width); }

        .languages-list ul { list-style: none; padding: 0; flex-grow: 1; }
        .languages-list li { margin-bottom: 25px; font-size: 1.2rem; display: flex; align-items: center; gap: 20px; border-bottom: 1px dashed var(--border-color); padding-bottom: 20px; transition: border-color 0.5s ease; }
        .languages-list li:last-child { border-bottom: none; margin-bottom: 0; }
        .languages-list li i { color: var(--accent1); font-size: 1.8rem; flex-shrink: 0; transition: all 0.3s ease; text-shadow: 0 0 10px var(--glow-color1); filter: drop-shadow(0 0 6px var(--glow-color1)); will-change: transform, color, filter, text-shadow; }
        .languages-list li:hover i { color: var(--accent2); transform: scale(1.3) rotate(-8deg); filter: drop-shadow(0 0 10px var(--glow-color2)); text-shadow: 0 0 12px var(--glow-color2); }
        .languages-list li div { line-height: 1.5; }
        .languages-list li strong { display: block; color: var(--text-primary); transition: color 0.5s ease; }
        .languages-list li small { color: var(--text-secondary); font-size: 0.9em; transition: color 0.5s ease; }

        /* --- Footer --- */
        footer { background-color: transparent; color: var(--text-secondary); text-align: center; padding: 50px 0; margin-top: 100px; border-top: 2px solid var(--border-color); font-size: 1rem; position: relative; transition: color 0.5s ease, border-color 0.5s ease; }
        footer::before { content: ''; position: absolute; top: -2px; left: 0; right: 0; height: 5px; background: var(--accent-gradient); opacity: 0.7; filter: blur(6px); transition: background 0.5s ease, opacity 0.5s ease; }
        .footer-controls { display: flex; justify-content: center; align-items: center; gap: 15px; margin-top: 20px; }
        .chandelier { font-size: 2rem; cursor: pointer; transition: color 0.3s ease, text-shadow 0.3s ease; color: var(--chandelier-icon-color); }
        .chandelier.on i { animation: var(--chandelier-glow-animation); }
        /* Specific animation for night mode chandelier */
        body:not(.light-mode) .chandelier.on i { --chandelier-glow-animation: chandelierGlow 1.5s infinite alternate; }

        /* --- Responsive --- */
        @media (max-width: 992px) { html { font-size: 15px; } .container { padding: 0 25px; } h2.section-title { font-size: 2.6rem; margin-bottom: 4rem; } .profile-pic-large { width: 250px; height: 250px; } #hero .alias { font-size: 3.5rem; } #hero .name { font-size: 2.2rem; } .skills-languages-grid { grid-template-columns: 1fr; } .about-content-wrapper { flex-direction: column; } .personal-info-list { border-inline-start: none; padding-inline-start: 0; border-top: 2px solid var(--border-color); padding-top: 35px; margin-top: 35px;} .contact-grid { grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); } #sphere-container { height: 400px; } }
        @media (max-width: 768px) { section { padding: 80px 0; } h2.section-title { font-size: 2.3rem; } .timeline::after { left: 30px; body[dir="rtl"] & { right: 30px; left: auto; } } .timeline-item { width: 100%; padding-left: 70px; padding-right: 15px; left: 0 !important; body[dir="rtl"] & { padding-right: 70px; padding-left: 15px; } text-align: right; }
            /* Mobile timeline animation reset */
             .timeline-item:not(.visible) { opacity: 0; transform: translateY(50px) scale(0.95); skew: 0; }
             .timeline-item.visible { opacity: 1; transform: translateY(0) scale(1); }

             .timeline-item::after { left: 19px; top: 30px; body[dir="rtl"] & { left:auto; right: 19px; } }
             .timeline-content::after { left: -30px; border-right-color: var(--bg-card-transparent); border-left-color: transparent; right: auto; body[dir="rtl"] & { right: -30px; border-left-color: var(--bg-card-transparent); border-right-color: transparent; left: auto; } }
             #sphere-container { height: 350px; max-width: 90%; } .profile-pic-large { width: 200px; height: 200px; } #hero .alias { font-size: 3rem; } #hero .name { font-size: 2rem; } }
        @media (max-width: 576px) { html { font-size: 14px; } .controls { top: 20px; right: 20px; } .control-btn { width: 45px; height: 45px; font-size: 1.3rem;} h2.section-title { font-size: 2rem; margin-bottom: 3.5rem; padding-bottom: 20px; } h2.section-title::after { width: 120px; height: 4px;} .profile-pic-large { width: 180px; height: 180px; } #hero .alias { font-size: 2.8rem; } #hero .name { font-size: 1.8rem; } #hero .title { font-size: 1.2rem; } section { padding: 70px 0;} .card, .about-content-wrapper, .contact-item, .timeline-content, .skills-list, .languages-list { padding: 30px; } .timeline-item { padding-left: 65px; body[dir="rtl"] & {padding-right: 65px;} } .timeline::after { left: 25px; body[dir="rtl"] & {right: 25px;} } .timeline-item::after { left: 14px; body[dir="rtl"] & {right: 14px;} } #sphere-container { height: 300px; } .contact-grid { grid-template-columns: 1fr; } .personal-info-list li { font-size: 1rem; } .timeline-content p { font-size: 1rem; } .languages-list li { font-size: 1.1rem;} }

        /* --- نهاية CSS --- */
    </style>
</head>
<body>

    <div id="star-container"></div>
    <div id="sun"></div>
    <div id="root"></div>

    <script type="text/babel" data-type="module">
        import * as THREE from 'three';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';

        const { useState, useEffect, useRef, useCallback } = React;

        // --- Helper: Intersection Observer Hook ---
        function useIntersectionObserver(options) {
            const [entry, setEntry] = useState(null);
            const [node, setNode] = useState(null);

            const observer = useRef(null);

            const disconnect = useCallback(() => {
                if (observer.current) {
                    observer.current.disconnect();
                }
            }, []);

            useEffect(() => {
                disconnect(); // Disconnect previous observer if node changes
                if (node) {
                    observer.current = new IntersectionObserver(([entry]) => {
                        setEntry(entry);
                        if (entry.isIntersecting) {
                             // Optional: Unobserve after intersecting once
                             // observer.current.unobserve(node);
                        }
                    }, options);
                    observer.current.observe(node);
                }
                // Cleanup function
                return () => disconnect();
            }, [node, options, disconnect]);

            return [setNode, entry];
        }

         // --- Helper: Debounce ---
         function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }


        // --- Components ---

        function Section({ children, id, ...props }) {
            const [setNode, entry] = useIntersectionObserver({ threshold: 0.1, rootMargin: '0px 0px -10% 0px' });
            const isVisible = entry?.isIntersecting;

            // Use effect to apply visibility class - better control than direct className logic
            useEffect(() => {
                if (isVisible && nodeRef.current) {
                    nodeRef.current.classList.add('visible');
                }
                // Note: We don't remove the class here to keep animation state
            }, [isVisible]);

             const nodeRef = useRef(); // Ref to manage the classlist directly

            return (
                <section
                    id={id}
                    ref={node => { // Assign node to both refs
                        setNode(node);
                        nodeRef.current = node;
                    }}
                    {...props}
                >
                    {children}
                </section>
            );
        }

        const HeroSection = React.memo(() => {
             // Hero section doesn't need observer, visible by default
             return (
                <section id="hero">
                    <img src="https://i.postimg.cc/3JpXLt6Z/IMG.jpg" alt="صورة محمود سعد الشخصية" className="profile-pic-large" />
                    <h1 className="alias">メآمـہ‏‏ـن آلدول‏‏هہメ</h1>
                    <h2 className="name">محمود سعد</h2>
                    <p className="title">خبير دعم فني وإداري لتطبيقات الدردشة الصوتية المتقدمة</p>
                </section>
             );
        });

        const AboutSection = React.memo(() => {
            const personalInfo = [
                 { icon: "fas fa-user-astronaut", label: "الاسم", value: "محمود سعد"},
                 { icon: "fas fa-calendar-star", label: "تاريخ الميلاد", value: "1 يناير 1997 (العمر: 27)"},
                 { icon: "fas fa-mars", label: "الجنس", value: "رجل"},
                 { icon: "fas fa-atom", label: "الحالة", value: "أعزب"},
                 { icon: "fas fa-flag-checkered", label: "الجنسية", value: "مصري"},
                 { icon: "fas fa-map-marked-alt", label: "الإقامة", value: "القاهرة، مصر"},
                 { icon: "fas fa-kaaba", label: "الديانة", value: "الإسلام"},
                 { icon: "fas fa-user-shield", label: "الخدمة العسكرية", value: "تمت"},
                 { icon: "fas fa-heart-pulse", label: "الصحة", value: "ممتازة"}
            ];

            return (
                <Section id="about">
                     <div className="about-content-wrapper card">
                        <div className="about-text">
                            <h3>لمحة تعريفية</h3>
                            <p>
                                أمتلك رؤية متقدمة في إدارة ودعم بيئات الدردشة الصوتية المعقدة. متخصص في تحليل وحل المشكلات التقنية والإدارية بكفاءة عالية، مع التركيز على تحسين تجربة المستخدم وضمان استقرار الأنظمة. أتابع أحدث التطورات في مجال الاتصالات الرقمية وأسعى لتوظيف خبراتي في تطوير حلول مبتكرة وفعالة.
                            </p>
                        </div>
                        <ul className="personal-info-list">
                           {personalInfo.map((item, index) => (
                                <li key={index} style={{ '--animation-delay': `${0.6 + index * 0.1}s` }}> {/* Apply delay */}
                                    <i className={item.icon}></i>
                                    <strong>{item.label}:</strong> {item.value}
                                </li>
                           ))}
                        </ul>
                    </div>
                </Section>
            );
        });

         const ContactSection = React.memo(() => {
             const contacts = [
                 { icon: "fas fa-mobile-screen-button", href: "tel:+2015018607072", text: "+20 150 186 07072" },
                 { icon: "fas fa-envelope-open-text", href: "mailto:java88449@gmail.com", text: "java88449@gmail.com" },
                 { icon: "fab fa-whatsapp", href: "https://wa.me/201501860702", text: "+20 150 186 0702", label: "WhatsApp" },
                 { icon: "fas fa-satellite-dish", href: "https://15018607022.github.io/Haawa/", text: "الموقع الشخصي" },
                 { icon: "fab fa-youtube", href: "https://youtube.com/@haawaau", text: "YouTube" },
                 { icon: "fab fa-facebook-f", href: "https://www.facebook.com/share/16aCzosts6/", text: "Facebook" },
                 { icon: "fab fa-tiktok", href: "https://www.tiktok.com/@pnu_150", text: "TikTok" },
                 { icon: "fab fa-instagram", href: "https://www.instagram.com/m10_0006", text: "Instagram" },
             ];
            return (
                 <Section id="contact">
                    <h2 className="section-title">بوابات الاتصال</h2>
                    <div className="contact-grid">
                         {contacts.map((contact, index) => (
                             <div key={index} className="contact-item card">
                                <i className={contact.icon}></i>
                                <a href={contact.href} target="_blank" rel="noopener noreferrer">{contact.text}</a>
                                {contact.label && <span>{contact.label}</span>}
                            </div>
                         ))}
                    </div>
                </Section>
            );
         });

         // --- Abstract Sphere Component ---
        const AbstractSphere = React.memo(({ currentMode }) => {
            const mountRef = useRef(null);
            const rendererRef = useRef(null);
            const animationFrameIdRef = useRef(null);
            const sceneRef = useRef(null);
            const cameraRef = useRef(null);
            const controlsRef = useRef(null);
            const sphereMeshRef = useRef(null);
            const clockRef = useRef(new THREE.Clock());

             // Cleanup function
             const cleanupThree = useCallback(() => {
                 cancelAnimationFrame(animationFrameIdRef.current);
                 animationFrameIdRef.current = null;
                 if (rendererRef.current) {
                     rendererRef.current.dispose(); // Dispose renderer resources
                     if (rendererRef.current.domElement.parentNode) {
                        rendererRef.current.domElement.parentNode.removeChild(rendererRef.current.domElement);
                     }
                     rendererRef.current = null;
                 }
                  if (sceneRef.current) {
                     // Dispose geometries, materials in the scene
                     sceneRef.current.traverse(object => {
                         if (object.geometry) object.geometry.dispose();
                         if (object.material) {
                              // Handle arrays of materials
                            if (Array.isArray(object.material)) {
                                object.material.forEach(material => material.dispose());
                            } else {
                                object.material.dispose();
                            }
                         }
                     });
                     sceneRef.current = null;
                 }
                 if(controlsRef.current) {
                     controlsRef.current.dispose();
                     controlsRef.current = null;
                 }
                 cameraRef.current = null;
                 sphereMeshRef.current = null;
                 clockRef.current = new THREE.Clock(); // Reset clock
             }, []);


            useEffect(() => {
                if (!mountRef.current) return;

                // --- Initialization ---
                 cleanupThree(); // Clean up previous instance first

                 sceneRef.current = new THREE.Scene();
                 const containerWidth = mountRef.current.clientWidth;
                 const containerHeight = mountRef.current.clientHeight;

                cameraRef.current = new THREE.PerspectiveCamera(60, containerWidth / containerHeight, 0.1, 1000);
                cameraRef.current.position.set(0, 0, 4);

                rendererRef.current = new THREE.WebGLRenderer({ antialias: true, alpha: true });
                rendererRef.current.setSize(containerWidth, containerHeight);
                rendererRef.current.setPixelRatio(Math.min(window.devicePixelRatio, 2));
                mountRef.current.appendChild(rendererRef.current.domElement);

                 const vertexShader = `
                    varying vec2 vUv; varying vec3 vNormal; uniform float time; uniform float amplitude;
                    float noise(vec3 p) { return sin(p.x * 1.5 + time) * sin(p.y * 1.5 + time) * sin(p.z * 1.5 + time) * 0.5 + 0.5; }
                    void main() { vUv = uv; vNormal = normal; vec3 pos = position; float displacement = noise(normal * 3.0) * amplitude; pos += normal * displacement; gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0); }`;
                 const fragmentShader = `
                    varying vec2 vUv; varying vec3 vNormal; uniform float time; uniform vec3 color1; uniform vec3 color2;
                    void main() { float intensity = pow(0.7 - dot(vNormal, vec3(0.0, 0.0, 1.0)), 2.0); vec3 baseColor = mix(color1, color2, smoothstep(0.0, 1.0, vUv.y + sin(time * 0.5) * 0.2)); gl_FragColor = vec4(baseColor + intensity * vec3(0.8, 0.8, 1.0), 1.0); }`;

                 const material = new THREE.ShaderMaterial({
                     vertexShader, fragmentShader,
                     uniforms: {
                         time: { value: 0 }, amplitude: { value: 0.15 },
                         color1: { value: new THREE.Color(getComputedStyle(document.body).getPropertyValue('--accent1').trim()) },
                         color2: { value: new THREE.Color(getComputedStyle(document.body).getPropertyValue('--accent2').trim()) }
                     },
                 });

                sphereMeshRef.current = new THREE.Mesh(new THREE.IcosahedronGeometry(1.5, 5), material);
                sceneRef.current.add(sphereMeshRef.current);

                sceneRef.current.add(new THREE.AmbientLight(0xffffff, 0.5));
                const pointLight = new THREE.PointLight(0xffffff, 0.8);
                pointLight.position.set(5, 5, 5);
                sceneRef.current.add(pointLight);

                controlsRef.current = new OrbitControls(cameraRef.current, rendererRef.current.domElement);
                controlsRef.current.enableDamping = true; controlsRef.current.dampingFactor = 0.05;
                controlsRef.current.enableZoom = false; controlsRef.current.autoRotate = true;
                controlsRef.current.autoRotateSpeed = 0.8; controlsRef.current.enablePan = false;

                // --- Animation Loop ---
                const animate = () => {
                    if (!rendererRef.current || !sceneRef.current || !cameraRef.current) { // Check if cleaned up
                         animationFrameIdRef.current = null;
                         return;
                    }
                    animationFrameIdRef.current = requestAnimationFrame(animate);
                    const elapsedTime = clockRef.current.getElapsedTime();
                    if (sphereMeshRef.current && sphereMeshRef.current.material.uniforms) {
                         sphereMeshRef.current.material.uniforms.time.value = elapsedTime;
                         // Update colors based on current theme ONLY IF NEEDED (can be slow)
                         // sphereMeshRef.current.material.uniforms.color1.value.set(getComputedStyle(document.body).getPropertyValue('--accent1').trim());
                         // sphereMeshRef.current.material.uniforms.color2.value.set(getComputedStyle(document.body).getPropertyValue('--accent2').trim());
                     }
                    controlsRef.current.update();
                    rendererRef.current.render(sceneRef.current, cameraRef.current);
                };
                 animate(); // Start animation

                // --- Resize Handler ---
                const handleResize = debounce(() => {
                    if (rendererRef.current && cameraRef.current && mountRef.current) {
                        const width = mountRef.current.clientWidth;
                        const height = mountRef.current.clientHeight;
                        cameraRef.current.aspect = width / height;
                        cameraRef.current.updateProjectionMatrix();
                        rendererRef.current.setSize(width, height);
                    }
                }, 250); // Debounced resize
                 window.addEventListener('resize', handleResize);

                // --- Cleanup on unmount ---
                return () => {
                     window.removeEventListener('resize', handleResize);
                     cleanupThree();
                 };

            }, [cleanupThree]); // Run effect only on mount and unmount


             // Update shader colors when theme changes
             useEffect(() => {
                 if (sphereMeshRef.current?.material.uniforms) {
                     sphereMeshRef.current.material.uniforms.color1.value.set(getComputedStyle(document.body).getPropertyValue('--accent1').trim());
                     sphereMeshRef.current.material.uniforms.color2.value.set(getComputedStyle(document.body).getPropertyValue('--accent2').trim());
                 }
             }, [currentMode]);

            return <div id="sphere-container" ref={mountRef}></div>;
        });


        const ExperienceSection = React.memo(() => {
            const experiences = [
                {
                    title: "إدارة ودعم العملاء",
                    company: "تطبيق نبض ليف (منصة صوتية)",
                    date: "يناير 2024 - يناير 2025",
                    description: "قيادة عمليات الدعم الفني والإداري للمستخدمين والوكلاء ضمن بيئة التطبيق. تطوير استراتيجيات حل المشكلات وتحسين تجربة المستخدم. الإشراف على الامتثال للسياسات التشغيلية وتحليل بيانات الأداء."
                }
                // Add more experiences here
            ];

             // Refs for IntersectionObserver
             const itemRefs = useRef([]);
             itemRefs.current = []; // Reset refs on each render

             const addToRefs = (el) => {
                 if (el && !itemRefs.current.includes(el)) {
                     itemRefs.current.push(el);
                 }
             };

             // Observer for timeline items
             useEffect(() => {
                 const observerOptions = { threshold: 0.2, rootMargin: '0px 0px -10% 0px' };
                 const callback = (entries, obs) => {
                     entries.forEach((entry, index) => {
                         if (entry.isIntersecting) {
                             // Calculate staggered delay
                             const delay = 0.2 + index * 0.2; // Base delay + increment
                             entry.target.style.setProperty('--animation-delay', `${delay}s`);
                             entry.target.classList.add('visible');
                             obs.unobserve(entry.target); // Observe only once
                         }
                     });
                 };
                 const observer = new IntersectionObserver(callback, observerOptions);
                 itemRefs.current.forEach(item => observer.observe(item));

                 return () => observer.disconnect(); // Cleanup observer
             }, [experiences]); // Rerun if experiences change


            return (
                 <Section id="experience">
                    <h2 className="section-title">المسار المهني</h2>
                    <div className="timeline">
                        {experiences.map((exp, index) => (
                            <div key={index} className="timeline-item" ref={addToRefs}>
                                <div className="timeline-content card">
                                    <h3>{exp.title}</h3>
                                    <h4>{exp.company}</h4>
                                    <span className="date">
                                        <i className="fas fa-calendar-check"></i> {exp.date}
                                    </span>
                                    <p>{exp.description}</p>
                                </div>
                            </div>
                        ))}
                    </div>
                </Section>
            );
        });

        const SkillsSection = React.memo(() => {
             const skills = [
                 { name: "دعم فني متقدم وخدمة عملاء", level: "expert", progress: 95, icon: "fas fa-headset" },
                 { name: "تحليل وحل المشكلات المعقدة", level: "expert", progress: 90, icon: "fas fa-lightbulb" },
                 { name: "إدارة حسابات المستخدمين والوكلاء", level: "advanced", progress: 85, icon: "fas fa-users-cog" },
                 { name: "التواصل الفعال وإدارة الفرق", level: "expert", progress: 95, icon: "fas fa-comments" },
             ];
             const languages = [
                 { name: "العربية", level: "اللغة الأم", icon: "fas fa-language" },
                 { name: "الإنجليزية", level: "مستوى احترافي / متقدم", icon: "fas fa-language" },
             ];

              // Ref for IntersectionObserver on the skills list container
             const skillsListRef = useRef();
             const [setSkillsListRefNode, entry] = useIntersectionObserver({ threshold: 0.2 });
             const skillsVisible = entry?.isIntersecting;

             // Assign ref to the observer hook
             useEffect(() => {
                 setSkillsListRefNode(skillsListRef.current);
             }, [setSkillsListRefNode]);


            return (
                 <Section id="skills">
                     <h2 className="section-title">القدرات واللغات</h2>
                    <div className="skills-languages-grid">
                         <div
                             className={`skills-list card ${skillsVisible ? 'visible' : ''}`}
                             ref={skillsListRef} // Attach ref here
                         >
                            <h3>المهارات الأساسية</h3>
                             {skills.map((skill, index) => (
                                <div key={index} className="skill-item">
                                    <span className="skill-name"><i className={skill.icon}></i> {skill.name}</span>
                                    <div className={`skill-level ${skill.level}`}>{skill.level === 'expert' ? 'خبير' : skill.level === 'advanced' ? 'متقدم' : skill.level}</div>
                                    <div className="progress-bar-container">
                                        <div
                                            className="progress-bar"
                                            style={{ '--progress-width': `${skill.progress}%` }}
                                        ></div>
                                    </div>
                                </div>
                             ))}
                        </div>
                         <div className="languages-list card">
                             <h3>اللغات المتقنة</h3>
                             <ul>
                                {languages.map((lang, index) => (
                                     <li key={index}>
                                        <i className={lang.icon}></i>
                                        <div>
                                            <strong>{lang.name}</strong><br />
                                            <small>({lang.level})</small>
                                        </div>
                                    </li>
                                ))}
                             </ul>
                         </div>
                    </div>
                </Section>
            );
        });

        const Footer = React.memo(({ onChandelierToggle, isChandelierOn }) => {
            return (
                 <footer>
                    <div className="container">
                        <p>تصميم وتطوير محمود سعد © 2025</p>
                         <div className="footer-controls">
                            <span
                                id="chandelier"
                                className={`chandelier ${isChandelierOn ? 'on' : ''}`}
                                aria-label="تبديل إضاءة الثريا"
                                onClick={onChandelierToggle} // Added click handler
                            >
                                <i className="fas fa-lightbulb"></i>
                            </span>
                        </div>
                    </div>
                </footer>
            );
        });

        // --- Main App Component ---
        function App() {
            const [mode, setMode] = useState(localStorage.getItem('themeMode') || 'night');
            const [isChandelierOn, setIsChandelierOn] = useState(false);
            const [starElements, setStarElements] = useState([]);
            const [shootingStarElements, setShootingStarElements] = useState([]);

            // Apply mode class to body
            useEffect(() => {
                document.body.classList.toggle('light-mode', mode === 'day');
                localStorage.setItem('themeMode', mode);
            }, [mode]);

            // Toggle Mode
            const handleModeToggle = useCallback(() => {
                setMode(prevMode => (prevMode === 'night' ? 'day' : 'night'));
            }, []);

            // Toggle Chandelier
             const handleChandelierToggle = useCallback(() => {
                 setIsChandelierOn(prev => !prev);
             }, []);


             // Starry Background Effect
             useEffect(() => {
                 const starContainer = document.getElementById('star-container');
                 if (!starContainer) return;

                 const numStars = window.innerWidth < 768 ? 50 : 150;
                 const numShootingStars = 2;
                 let createdStars = [];
                 let createdShootingStars = [];

                 // Clear previous stars
                 starContainer.innerHTML = '';

                 // Create static stars
                 for (let i = 0; i < numStars; i++) {
                     const star = document.createElement('div');
                     star.className = 'star';
                     star.style.top = `${Math.random() * 100}%`;
                     star.style.left = `${Math.random() * 100}%`;
                     const size = Math.random() * 2 + 1;
                     star.style.width = `${size}px`; star.style.height = `${size}px`;
                     star.style.animationDelay = `${Math.random() * 5}s`;
                     star.style.animationDuration = `${Math.random() * 3 + 2}s`;
                     starContainer.appendChild(star);
                     createdStars.push(star);
                 }

                 // Create shooting stars
                 for (let i = 0; i < numShootingStars; i++) {
                     const star = document.createElement('div');
                     star.className = 'shooting-star';
                     const duration = Math.random() * 5 + 5;
                     star.style.animationDuration = `${duration}s`;
                     star.style.animationDelay = `${Math.random() * 10}s`;
                     star.style.top = `${Math.random() * 60}%`;
                     starContainer.appendChild(star);
                     createdShootingStars.push(star);
                 }

                 setStarElements(createdStars);
                 setShootingStarElements(createdShootingStars);

                 // Cleanup function
                 return () => {
                     createdStars.forEach(s => s.remove());
                     createdShootingStars.forEach(s => s.remove());
                 };
             }, []); // Run only once on mount


            return (
                <>
                    <div className="controls">
                        <button id="mode-toggle" className="control-btn" aria-label="تبديل الوضع" onClick={handleModeToggle}>
                            <i className="fas fa-moon"></i>
                            <i className="fas fa-sun"></i>
                        </button>
                    </div>

                    <main className="container">
                        <HeroSection />
                        <AboutSection />
                        <ContactSection />
                        <Section id="abstract-sphere-section"> {/* Wrap sphere in Section */}
                            <h2 className="section-title">نافذة تفاعلية</h2>
                            <AbstractSphere currentMode={mode} />
                        </Section>
                        <ExperienceSection />
                        <SkillsSection />
                    </main>

                    <Footer onChandelierToggle={handleChandelierToggle} isChandelierOn={isChandelierOn} />
                </>
            );
        }

        // --- Render App ---
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);

    </script>

</body>
</html>
